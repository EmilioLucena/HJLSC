version: '3'

services:

  mongodb:
    image: mongo:4.2.8
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: mongodbuser
      MONGO_INITDB_ROOT_PASSWORD: mongodbpassword
      MONGO_INITDB_DATABASE: flaskdb
    volumes: 
     - ./data:/data/db

  api:
    build: .
    ports:
     - "5000:5000"
    volumes:
     - .:/code
    environment:
      HOST: 0.0.0.0  
      PORT: 5000
      MONGODB_DATABASE: flaskdb
      MONGODB_USERNAME: mongodbuser
      MONGODB_PASSWORD: mongodbpassword
      MONGODB_HOSTNAME: mongodb
    depends_on:
      - mongodb